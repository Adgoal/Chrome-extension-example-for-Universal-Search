!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}({0:function(e,t,n){"use strict";const r={COOKIE_KEY:"usConfigVerified",STORAGE_STABLE_KEY:"usConfigStable",STORAGE_NEW_KEY:"usConfigNew",STORAGE_E_TAG_STABLE_KEY:"usConfigETagStable",STORAGE_E_TAG_NEW_KEY:"usConfigETagNew"},o={MESSAGE_US_START:"universalSearchStart",MESSAGE_US_CHECK_LINKS:"universalSearchCheckLinks",MESSAGE_US_DATA:"universalSearchData",MESSAGE_US_APPROVE_NEW_CONFIG:"universalSearchApproveNewConfig",MESSAGE_US_EXCEPTION:"universalSearchException"};n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},30:function(e,t,n){"use strict";n.r(t);class r{constructor(){this.key="NO_SEARCH_BLOCK"}}class o{constructor(){this.key="NO_LINK_BLOCKS"}}class s{constructor(){this.key="NO_LINKS"}}class c{constructor(){this.key="NO_POSITIONING_PIVOTS"}}class i{constructor(){this.key="NO_SEARCH_INPUT"}}class a{constructor(){this.key="NO_QUERY_SEARCH_TEXT_KEY"}}class l{constructor(){this.key="PARSING_EXCEPTION"}}var u=class{constructor(e){this.config=e}getQuerySearchText(){for(const e of this.config.queryKeywordKeys){const t=new URLSearchParams(window.location.search).get(e);if(t)return t}throw new a(window.location.href)}getQueryPage(){for(const e of this.config.queryPageKeys){const t=new URLSearchParams(window.location.search).get(e);if(t)return t}}};var f=class{constructor(e){this.config=e}getDOMElements(){const{searchBlockPatterns:e}=this.config;let t=null,n=null;for(const r of e)if(t=window.document.querySelector(r),t&&(n=this.getLinkBlocks(t),this.isAllNecessaryElementsFound(n)))return{searchBlock:{pattern:r,element:t},linkBlocks:n};this.throwException(t,n)}getLinkBlocks(e){const{linkBlockPatterns:t}=this.config;for(const n of t){const t=e.querySelectorAll(n);if(t.length)return t.forEach(e=>{e.link=this.getLink(e),e.pivotElement=this.getPositioningPivot(e)}),{pattern:n,elements:t}}}getLink(e){const{linkPatterns:t}=this.config;for(const n of t){const t=e.querySelector(n);if(t&&"A"===t.tagName)return{pattern:n,element:t}}}getPositioningPivot(e){const{before:t=null,after:n=null}=this.config.positioning,r=t||n;for(const t of r){const n=e.querySelector(t);if(n)return{pattern:t,element:n}}}isAllNecessaryElementsFound(e){return e&&e.elements[0].link&&!!e.elements[0].pivotElement}getSearchInputText(){for(const e of this.config.searchInputPatterns){const t=window.document.querySelector(e);if(t&&t.value)return t.value}throw new i}throwException(e,t){switch(!0){case!e:throw new r;case!t||!t.elements.length:throw new o;case!t.elements[0].link:throw new s;case!t.elements[0].pivotElement:throw new c;default:throw new l}}};var h=class{constructor(e){this.config=e}collectAllChildElementsParams(e){const{logTagNamesToExclude:t}=this.config,n=e.childNodes,r=[];return n.forEach(e=>{if(!e.tagName||t.includes(e.tagName.toLowerCase()))return;const{tagName:n,id:o,className:s,href:c}=e,i={tagName:n,id:o,className:s,childElementsParams:this.collectAllChildElementsParams(e)};c&&(i.href=c),r.push(i)}),r}};var g=class{static parseHref(e,t){const n=new RegExp(t),r=e.match(n);return r?r[1]:e}static decodeHref(e,t){for(let n=0;n<t;n++)e=decodeURIComponent(e);return e}};var m=class{constructor(e){this.config=e}parseLinks(e){const{decodeNumberTimes:t,specificParseRule:n,hrefRegex:r}=this.config,o=[];return e.forEach(e=>{const{link:s}=e;if(!s)return;const c=g.decodeHref(s.element.href,t);o.push(n?g.parseHref(c,r):c)}),o}};var E=class{constructor(e,t){this.config=e,this.searchElements=t}applyChanges(e){const{specificParseRule:t,hrefRegex:n}=this.config,{linkBlocks:r}=this.searchElements;r.elements.forEach(r=>{if(!r.link)return;const{element:o}=r.link;o&&e.forEach(e=>{const s=t?g.parseHref(o.href,n):o.href;e.url===s&&(this.replaceLink(o,e),this.insertLogoIn(r,this.createLinkBlock(e.logoBlock)))})})}replaceLink(e,t){const n=e.cloneNode(!0),r=this.addLinkEventListeners(n,t.transformedHref);e.parentNode.replaceChild(r,e)}addLinkEventListeners(e,t){let n="";return e.addEventListener("mouseover",(function(){n=n||this.href,this.href=n})),e.addEventListener("mouseup",(function(){this.href=t})),e}createLinkBlock({linkProps:e,imageProps:t}){const{parentBlock:n,link:r,img:o}=this.config.newElementsParams,s=Object.assign(document.createElement("div"),n),c=Object.assign(document.createElement("a"),r,e),i=Object.assign(document.createElement("img"),o,t);return c.appendChild(i),s.appendChild(this.addLinkEventListeners(c,e.transformedHref)),s}insertLogoIn(e,t){const{before:n=null}=this.config.positioning,{element:r}=e.pivotElement,o=n?r:r.nextSibling;r.parentNode.insertBefore(t,o)}},d=n(0);const p={},S={origin:location.origin,hostname:location.hostname,pathname:location.pathname,href:location.pathname};chrome.runtime.sendMessage({message:d.b.MESSAGE_US_START,payload:{location:S}}),chrome.runtime.onMessage.addListener(e=>{if(e.message!==d.b.MESSAGE_US_DATA)return;const{payload:t={}}=e;if(t.config){try{!function(e){p.config=e;const t=new u(e),n=new f(e),r=t.getQuerySearchText(),o=n.getSearchInputText();p.searchElements={searchText:e.isInputKeywordFirst?o:r,pageNumber:t.getQueryPage(),...n.getDOMElements()}}(t.config)}catch(e){return function({key:e}){const t=new h(p.config).collectAllChildElementsParams(document.body);chrome.runtime.sendMessage({message:d.b.MESSAGE_US_EXCEPTION,payload:{location:S,key:e,logValue:t}})}(e),void console.error("Error: "+e.key)}!function(){const{config:e,searchElements:t}=p,{linkBlocks:n,searchText:r,pageNumber:o}=t,s=new m(e).parseLinks(n.elements);chrome.runtime.sendMessage({message:d.b.MESSAGE_US_CHECK_LINKS,payload:{location:S,searchText:r,pageNumber:o,parsedLinks:s}})}()}t.transformedLinks&&(!function(e){const{config:t,searchElements:n}=p;new E(t,n).applyChanges(e)}(t.transformedLinks),p.config.isConfigNew&&chrome.runtime.sendMessage({message:d.b.MESSAGE_US_APPROVE_NEW_CONFIG}))})}});